<admintpl file="header" />
</head>
<body>
	<div class="wrap js-check-wrap">
		<ul class="nav nav-tabs">
			<li class="active"><a href="{:U('order_return_list')}">退换申请列表</a></li>
		</ul>
		<form class="well form-search" method="post" action="{:U('order_return_list')}">
			订单编号:
			<input type="text" name="order_sn" style="width: 120px;" value="{$order_sn}" placeholder="订单编号">&nbsp;
			顾客:
			<input type="text" name="customer_name" style="width: 120px;" value="{$customer_name}" placeholder="请输入顾客">&nbsp;
			<if condition="$is_stockman eq 1">
				销售员:
				<input type="text" name="apply_name" style="width: 120px;" value="{$apply_name}" placeholder="销售员姓名">&nbsp;
			</if>
			申请时间：
			<input type="text" name="start_time" class="js-datetime" value="{$start_time|default=''}" style="width: 125px;" placeholder="起始时间" autocomplete="off">-
			<input type="text" class="js-datetime" name="end_time" value="{$end_time|default=''}" style="width: 125px;" placeholder="结束时间" autocomplete="off"> &nbsp;
			<input type="submit" class="btn btn-primary" value="搜索">
		</form>
		<table class="table table-hover table-bordered">
			<thead>
				<tr>
					<th width="16"><label><input type="checkbox" class="js-check-all" data-direction="x" data-checklist="js-check-x"></label></th>
					<th>订单编号</th>
					<th>购买数量</th>
					<th>问题个数</th>
					<th>原订单保质期</th>
					<th>客户名称</th>
					<th>退货原因</th>
					<th>退货申请人</th>
					<th>申请时间</th>
					<th>申请状态</th>
					<th width="120">操作</th>
				</tr>
			</thead>
			<tbody>

				<foreach name="list" item="vo">
				<tr>
					<td><input type="checkbox" class="js-check" data-yid="js-check-y" data-xid="js-check-x" name="ids[]" value="{$vo.id}"></td>
					<td>{$vo.order_sn}</td>
					<td>
						{$vo.goods_num}
					</td>
					<td>{$vo.return_goods_num} <a  href="javascript:void(0)" onclick="show_detail('{$vo.order_sn}','{$vo.id}')">[查看详情]</a></td>
					<td>{:date('Y-m-d H:i:s',$vo['can_return_time'])}</td>
					<td>{$vo.customer_name}</td>
					<td>{$vo.return_reason}</td>
					<td>{$vo.sales_name}</td>
					<td>{:date('Y-m-d H:i:s',$vo['createtime'])}</td>
					<td title="{$vo.reject_reason}">
						<switch name="vo.order_return_state">
							<case value="-3">换货完成</case>
							<case value="-2">退换申请中</case>
							<case value="-1">申请拒绝<br/>原因:{:mb_strimwidth($vo['reject_reason'],0,15,"...","utf-8")}</case>
							<case value="1">申请中</case>
							<case value="2">已出货</case>
						</switch>
					</td>
					<td>
						<if condition="sp_auth_check(get_current_admin_id(),'Admin/SellFlow/order_return_confirm')">
							<if condition="($vo.order_return_state eq 1) or ($vo.order_return_state eq -3)">
								<a href="{:U('order_return_confirm')}/order_sn/{$vo.order_sn}/id/{$vo.id}">确认换货</a>|
							</if>
						</if>
					</td>
				</tr>
				</foreach>
			</tbody>
		</table>
		<div class="pagination">{$page}</div>
	</div>
	<script src="__PUBLIC__/js/common.js"></script>
	<script src="__PUBLIC__/js/layer/layer.js"></script>
    <script>
		function show_detail(order_sn,return_id){
			layer.open({
				type: 2,
				area: ['600px', '400px'],
				title: '订单详情',
				fixed: false, //不固定
				maxmin: true,
				content: '{:U("SellFlow/order_goods_list")}'+'/order_sn/'+order_sn+'/return_id/'+return_id+'/is_abnormal/1'
			});
		}

	</script>
</body>
</html>