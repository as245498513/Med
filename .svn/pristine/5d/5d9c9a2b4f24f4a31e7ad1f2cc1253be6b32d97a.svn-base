<admintpl file="header"/>
</head>
<body>
	<div class="wrap js-check-wrap">
		<ul class="nav nav-tabs">
			<li><a href="{:U('script_list')}">脚本列表</a></li>
			<li class="active"><a href="{:U('script_upload')}">脚本上传</a></li>
		</ul>
		<form class="form-horizontal js-ajax-form" enctype="multipart/form-data" action="{:U('script_upload_post')}" method="post">
			<fieldset>
				<div class="control-group">
					<label class="control-label ">选择脚本</label>
					<div class="controls">
						<input type="text" size="20" name="script_name" id="script_name" readonly="readonly">
						<span >*(后缀为.xxt格式,上传文件名字格式为(版本号_文件名.xxt)如1.1_momo.xxt)</span>
						<!--<input type="file" class="btn btn-default" name="photo" />-->
						<input   id="file_upload" name="file_upload" type="file" multiple="true">
					</div>

				</div>

				<div class="control-group">
					<label class="control-label">版本号</label>
					<div class="controls">
						<input  type="text" name="script_version" value="" id="script_version" readonly="readonly"/>
						<span class="form-required">*(例如:1.0)</span>
					</div>
				</div>

				<div class="control-group">
					<label class="control-label">版本说明</label>
					<div class="controls">
						<textarea name="remark" id="remark"></textarea>
						<span class="form-required"></span>
					</div>
				</div>
			</fieldset>
			<div class="form-actions">
				<button type="submit" class="btn btn-primary js-ajax-submit">添加</button>
				<a class="btn" href="javascript:history.back(-1);">返回</a>
			</div>
		</form>
	</div>
	<script src="__PUBLIC__/js/common.js"></script>
	<script src="__PUBLIC__/js/uploadify/jquery.uploadify.min.js" type="text/javascript"></script>
	<script type="text/javascript">
		$(function() {
			$('#file_upload').uploadify({
				'formData'     : {
				},
				'buttonText' : '上传文件',
				'buttonClass': 'btn btn-primary ',
				'fileSizeLimit' : 100,
				'width'    : 100,
				'height'   :30,
				'multi'    : false,
				'fileTypeExts' : '*.xxt',
				'swf'      : '__PUBLIC__/js/uploadify/uploadify.swf',
				'uploader' : "{:U('script_upload_file')}",
				'onUploadComplete' : function(file) {

				},
				'onUploadSuccess' : function(file, data, response) {
					var j = JSON.parse(data);
					console.log(data)
					if(j.code == 0){
						alert(j.text);
					}
					$("#script_name").val(j.filepath);
					$("#script_version").val(j.version)

				}
			});
		});
	</script>

</body>
</html>