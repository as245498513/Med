<admintpl file="header" />
</head>
<body>
	<div class="wrap js-check-wrap">
		<ul class="nav nav-tabs">
			<li class="active"><a href="{:U('class_list')}">素材分类列表</a></li>
		</ul>
		<form class="well form-search" method="post" action="{:U('class_list')}">
			素材类型：
			<select id="type" name="source_type" style="width: 130px;">
				<option value="0"<if condition="$source_type  eq 0">selected="selected"</if>>全部</option>
				<option value="1" <if condition="$source_type eq 1">selected="selected"</if>>朋友圈图文素材</option>
				<option value="2" <if condition="$source_type eq 2">selected="selected"</if>>小视频素材</option>
				<option value="3" <if condition="$source_type eq 3">selected="selected"</if>>图片素材</option>
			</select>
			分类名称:
			<input type="text" name="class_name" style="width: 200px;font-size:9px;" value="{$class_name}" placeholder="请输入分类名称">&nbsp;

			<input type="submit" class="btn btn-primary" value="搜索">
			<if condition="sp_member_auth_check(sp_get_current_member_id(),'User/source/class_add')">
			   <a class="btn btn-success" href="{:U('User/source/class_add')}">新增</a>
			</if>
			<if condition="sp_member_auth_check(sp_get_current_member_id(),'User/source/class_del_post')">
			 <a class="btn btn-danger " href="javascript:void(0)" onclick="batch_del()">批量删除</a>
			</if>
		</form>
		<table class="table table-hover table-bordered">
			<thead>
				<tr>
					<th width="16"><label><input type="checkbox" class="js-check-all" data-direction="x" data-checklist="js-check-x"></label></th>
					<th width="50">序号</th>
					<th>分类名称</th>
					<th>素材类型</th>
					<th>分类排序</th>
					<th width="120">操作</th>
				</tr>
			</thead>
			<tbody>

				<foreach name="list" item="vo">
				<tr>
					<td><input type="checkbox" class="js-check" data-yid="js-check-y" data-xid="js-check-x" name="ids[]" value="{$vo.id}"></td>
					<td>{$vo.id}</td>
					<td>{$vo.class_name}</td>
					<td>
						<switch name="vo.source_type" >
							<case value="1">朋友圈图文素材</case>
							<case value="2">小视频素材</case>
							<case value="3">图片素材</case>
						</switch>
					<td>{$vo.class_sort}</td>
					<td>
						<if condition="sp_member_auth_check(sp_get_current_member_id(),'User/source/class_edit')">
						  <a href="{:U('class_edit')}/id/{$vo.id}">编辑</a>|
						</if>
						<if condition="sp_member_auth_check(sp_get_current_member_id(),'User/source/class_del_post')">
							<a href="javascript:void(0)" onclick="batch_del('{$vo.id}')">删除</a>
						</if>
					</td>
				</tr>
				</foreach>
			</tbody>
		</table>
		<div class="pagination">{$page}</div>
	</div>
	<script src="__PUBLIC__/js/common.js"></script>
	<script src="__PUBLIC__/js/layer/layer.js"></script>
    <script>
		/*function add(){
			layer.open({
				type: 2,
				title: '新增分类',
				closeBtn: 1, //不显示关闭按钮
				shadeClose: true, //开启点击遮罩关闭层
				area : ['700px' , '430px'],
				offset : ['100px', ''],
				anim: 2,
				content: ['{:U('class_add')}', 'no'], //iframe的url，no代表不显示滚动条
			});
		}*/

	  function batch_del(id){
		  var r=confirm("确定删除吗?");
		  if (r==true){
			  var ids=[];
			  //单个删除
			  if(id){
				  ids[0]=id;
			  }
			  //批量删除
			  $("input[name^='ids']:checked").each(function(i){
				  ids[i]=$(this).val();
			  });
			  $.ajax({
				  data:{ids:ids},
				  type: "post",
				  dataType:"json",
				  url:"{:U('class_del_post')}",
				  success:function(data){
                      if(data.code==0){
						  alert(data.data+"条数据"+data.message);
						  location.reload();
					  }else{
						  alert(data.message);
					  }
				  }
			  });
		  }
	  }

	</script>
</body>
</html>